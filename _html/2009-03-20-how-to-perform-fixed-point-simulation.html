---
layout: post
title: How to perform fixed-point simulation in SystemC
date: '2009-03-20T11:16:00.001+08:00'
author: 史蛋利九的部落格
tags:
- SystemC
- 科技先知
modified_time: '2011-01-10T23:08:31.505+08:00'
thumbnail: http://3.bp.blogspot.com/_4T1r1rg9hZ8/ScZLL_9P--I/AAAAAAAAAAs/Fnn9IsXAMGY/s72-c/logo_systemc.gif
blogger_id: tag:blogger.com,1999:blog-7536266430143612441.post-5707568914454184184
blogger_orig_url: https://stanlly9.blogspot.com/2009/03/how-to-perform-fixed-point-simulation.html
---

<span style="color: red; font-size: 180%;">W</span>hen you need to converts a floating-point digital signal processing program written in C or C++ language to a fixed-point program automatically.  Maybe the following tips will help.<br /><blockquote><a href="http://www.systemc.org/" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" target="_new"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5316019079676427234" src="http://3.bp.blogspot.com/_4T1r1rg9hZ8/ScZLL_9P--I/AAAAAAAAAAs/Fnn9IsXAMGY/s320/logo_systemc.gif" style="cursor: pointer; float: left; height: 63px; margin: 0pt 10px 10px 0pt; width: 161px;" /></a></blockquote>Recently, I have tried to using SystemC to perform a fixed-point simulation for my DSP program.  There are lots of built-in C++ classes [datatypes] for fixed-point representations, which are also very useful.  For examples, the support of operator overridding were compeletly done by OSCI.  Program designers can multiply the real values they want without considering the representations for  integer part and the decimal part.  All the rest jobs like scalling, signed extension, rounding are automatically performed by default.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_4T1r1rg9hZ8/SdD8A7Ex7UI/AAAAAAAAACs/qiZLh8IA7No/s1600-h/DSC_111_m.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><br /></a></div><span class="fullpost"><br />SystemC support many datatypes for fixed-point representations, such as :<br /><span style="font-style: italic; font-weight: bold;"><br /><span style="font-family: courier new; font-size: 130%;">sc_fix</span></span><span style="font-size: 130%;"> (</span><span style="color: #3333ff; font-size: 130%;">signed</span><span style="font-size: 130%;"> values)</span><span style="font-size: 130%; font-style: italic; font-weight: bold;"><br /><span style="font-family: courier new;">sc_ufix</span></span><span style="font-size: 130%;"> (</span><span style="color: #3333ff; font-size: 130%;">unsigned</span><span style="font-size: 130%;"> values)<br /></span><span style="font-family: courier new; font-size: 130%; font-style: italic; font-weight: bold;">sc_fixed </span><span style="font-size: 130%;">(signed values, </span><span style="color: #cc0000; font-size: 130%;">fixed word-length</span><span style="font-size: 130%;">)<br /></span><span style="font-family: courier new; font-size: 130%; font-style: italic; font-weight: bold;">sc_ufixed</span><span style="font-size: 130%;"> (unsigned values, </span><span style="color: #cc0000; font-size: 130%;">fixed word-length</span><span style="font-size: 130%;">)</span><br /><br />The difference between sc_fix and sc_fixed is that the sc_fixed version could only have a specificaly fixed word-length while compiling.  It also means that the sc_fix version can perform the <span style="color: #009900; font-weight: bold;">dynamic fixed-point precision</span> in <span style="color: #660000; font-weight: bold;">run-time</span>(you may <span style="color: #3333ff; font-weight: bold;">change</span> the word-length in some place if you want).<br /><a href="http://3.bp.blogspot.com/_4T1r1rg9hZ8/SdD8A7Ex7UI/AAAAAAAAACs/qiZLh8IA7No/s1600-h/DSC_111_m.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://3.bp.blogspot.com/_4T1r1rg9hZ8/SdD8A7Ex7UI/AAAAAAAAACs/qiZLh8IA7No/s320/DSC_111_m.jpg" /></a> <br />Besides, there are  <span style="color: #6600cc; font-style: italic; font-weight: bold;">_fast</span> versions for above 4 datatypes,  the <span style="color: #6600cc; font-style: italic; font-weight: bold;">_fast</span> version's precisions are limitted to a maximun length for 53-bits in order to speed up the simulation task.  I think the _fast version will be a help.  Since there is no need for high persions while perfoming fixed-point simulations.<br /><br />If you want to know the quatization noise effect on your application, I think the<br /><span style="color: #cc6600; font-weight: bold;">sc_fixed_fast</span> and <span style="color: #cc6600; font-style: italic; font-weight: bold;">sc_fixed</span> might be the most useful datatypes.<br /><br />Here are some usage about sc_fixed_fast:<br /><code><br /><span style="font-family: courier new; font-size: 130%;"><span style="color: #3333ff;">#define</span> <span style="color: #009900;">SC_INCLUDE_FX</span></span><span style="font-size: 130%;"><br /></span><span style="font-family: courier new; font-size: 130%;"><span style="font-style: italic; font-weight: bold;">sc_fixed_fast</span>&lt;8,3&gt; <span style="font-style: italic; font-weight: bold;">x</span>;</span><br /></code><br />First of all, the definition of <span style="color: #009900; font-weight: bold;">SC_INCLUDE_FX</span> enables the SystemC bulit-in library for fixed-point datatpyes.  <span style="color: #cc33cc; font-weight: bold;">Without</span> this definition, the library <span style="color: #cc33cc; font-weight: bold;">will not reconize</span> the sc_fix* datatypes.  You may see the release notes in the SystemC download resources.<br /><br />The <span style="font-family: courier new; font-weight: bold;">&lt;8,3&gt; </span>represents the total word-length and the integer word-length.<br />It follows the format as:<br /><span style="font-size: 130%;"><span style="font-family: courier new; font-weight: bold;"><wl,iwl></wl,iwl></span></span><wl,><span style="font-style: italic; font-weight: bold;"><wl,></wl,></span><span style="font-family: georgia; font-size: 130%; font-style: italic; font-weight: bold;"><wl,></wl,></span><br /><wl,>, where <span style="color: red; font-style: italic; font-weight: bold;">WL</span> is the <span style="color: #6633ff; font-style: italic; font-weight: bold;">word-length</span> and <span style="color: red; font-style: italic; font-weight: bold;">IWL</span> is the <span style="color: #6633ff; font-style: italic; font-weight: bold;">integer word-length</span>.<br /><br />You may see the <span style="color: #3366ff; font-style: italic; font-weight: bold;">x</span> variable as  "<span style="color: #009900; font-style: italic; font-weight: bold;">saa.bbbbb</span>" in which the '<span style="color: #cc33cc; font-style: italic; font-weight: bold;">saa</span>' are the <span style="font-style: italic; font-weight: bold;">signed bit</span> and the <span style="font-style: italic; font-weight: bold;">integer bits</span>.  And the 5-bits '<span style="color: #ff6666; font-style: italic; font-weight: bold;">bbbbb</span>'  are the <span style="font-style: italic; font-weight: bold;">decimal fraction</span> part.<br /><br />If you want to assign a real value '2.333' to x,  you just use:<br />x=2.333;<br />The rounding result for x will be 2.3125.   Here is an example for FIR filter...<br /></wl,></wl,><br /><a href="http://3.bp.blogspot.com/_4T1r1rg9hZ8/ScZKdPaS3lI/AAAAAAAAAAk/fcYEzmFirIk/s1600-h/qw.gif" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5316018276370931282" src="http://3.bp.blogspot.com/_4T1r1rg9hZ8/ScZKdPaS3lI/AAAAAAAAAAk/fcYEzmFirIk/s320/qw.gif" style="cursor: pointer; display: block; height: 288px; margin: 0px auto 10px; text-align: center; width: 374px;" /></a><br /></span>